---
import SectorList from "@/components/admin/SectorList";
import AdminLayout from "@/layouts/AdminLayout.astro";
import { createSupabaseServer } from "@/lib/supabase";

const supabase = createSupabaseServer(Astro.cookies, Astro.request);

const { data: sectors } = await supabase
  .from("business_sectors")
  .select("id, name, platforms, created_at, categories(count), locations(count)")
  .order("name");
---

<AdminLayout title="Settori">
  <div class="mb-6 flex items-center justify-between">
    <h1 class="text-2xl font-bold">Gestione Settori</h1>
    <a
      href="/regia/sectors/new"
      class="rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700"
    >
      Nuovo Settore
    </a>
  </div>

  <SectorList sectors={(sectors ?? []) as any} />
</AdminLayout>
